<!DOCTYPE html>
<html>    
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width initial-scale=1">

  <title>iOS开发UI阶段——第四节 触摸、手势</title>
  <meta name="description" content="触摸">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://github.com/NeighborWangShushu/neighborwangshushu.github.com/ios_objective-c/2016/02/26/iOS%E5%BC%80%E5%8F%91UI%E9%98%B6%E6%AE%B5-%E7%AC%AC%E5%9B%9B%E8%8A%82-%E8%A7%A6%E6%91%B8-%E6%89%8B%E5%8A%BF.html">
  <link rel="alternate" type="application/atom+xml" title="WangShuShu Blog" href="https://github.com/NeighborWangShushu/neighborwangshushu.github.com/feed.xml" />
  <script src="/scripts/jquery-1.11.2.min.js"></script>
  <script src="/scripts/pithy.js"></script>
</head>


  <body>
    <header class="header">
	<div class="header-container">
		<div class="nav">
			
				<li>
					<a href="/index.html">home</a>
				</li>			
			
			
				<li>
					<a href="/archive.html">archive</a>
				</li>			
			
			
				<li>
					<a href="/category.html">category</a>
				</li>			
			
			
				<li>
					<a href="/about.html">about</a>
				</li>			
			
		</div>
		<div class="description"> My surname really is Wang，I promise </div>		
		<ul class="social-links">
			<li>
				<a href="https://github.com/NeighborWangShuShu" title="Github">
					<img width="19px" height="19px" src="/images/github.png"/>
				</a>
			</li>
			<li>
				<a href="https://www.facebook.com/neighborwangshushu" title="Facebook">
					<img width="19px" height="19px" src="/images/facebook.png"/>
				</a>
			</li>
			<li>
				<a href="https://twitter.com/neighborwangshu" title="Twitter">
					<img width="19px" height="19px" src="/images/twitter.png"/>
				</a>
			</li>
			<li>
				<a href="mailto:NeighborWangShuShu@Gmail.com" title="Email">
					<img width="19px" height="19px" src="/images/email.png"/>
				</a>
			</li>
			<!-- <li>
				<a href="/feed.xml" title="RSS">
					<img width="19px" height="19px" src="/images/rss.png"/>
				</a>
			</li> -->
		</ul>		
	</div>
</header>

    <br>
    <div class="page-content">
      <div class="wrapper">
        <div class="post">
  <br>
  <header class="post-header">
    <h1 class="post-title">iOS开发UI阶段——第四节 触摸、手势</h1>
    <p class="post-meta">Feb 26, 2016</p>
  </header>

  <article class="post-content">
    <p>触摸</p>

<p>视图响应触摸的三个时间阶段的方法</p>

<p>触摸开始的方法</p>

<ul>
  <li>
    <p>(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
触摸移动的方法</p>
  </li>
  <li>
    <p>(void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
触摸结束的方法</p>
  </li>
  <li>
    <p>(void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
获取触摸在屏幕上的手指对象</p>
  </li>
</ul>

<p>UITouch *touch = [touches anyObject];</p>

<p>获取手指之前在屏幕上的位置</p>

<p>CGPoint previousP = [touch previousLocationInView:self];</p>

<p>获取手指现在在屏幕上的位置</p>

<p>CGPoint currentP = [touch locationInView:self];</p>

<p>响应者链</p>

<p>触摸检测查询 先UIApplication -&gt; window -&gt; viewController -&gt; view -&gt; 触摸的子视图</p>

<p>事件处理的顺序与触摸检测查询顺序相反，如果没有响应者处理事件，触摸事件则会被丢弃</p>

<p>关闭用户交互则会阻断响应者链，无法完成检测</p>

<p>默认关闭用户交互的空间有 UILabel 和 UIImageView</p>

<p>开启用户交互：imageView . userInteractionEnabled = YES;</p>

<p>手势</p>

<p>以imageView为例</p>

<p>①.创建满足需求的手势，再创建时关联手势触发时的方法</p>

<p>tip:创建手势的代码：[[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(tapAction:)];</p>

<p>②.配置手势的相关属性</p>

<p>③.将手势添加到需要执行操作的视图上面</p>

<p>tip:添加手势的代码：[imageView addGestureRecognizer:tap];</p>

<p>④.实现手势方法，当触摸发生，手势识别器识别到相对应的触摸时，就会执行关联方法</p>

<p>tip:关联手势的代码：[UIImageView *imageView = (UIImageView *)longPress.view]; //返回值为UIView 所以要进行类型强转</p>

<p>轻拍手势 UITapGestureRecognizer</p>

<p>包含的属性：</p>

<p>1.触发手势的手指个数  tap.numberOfTouchesRequired = 1;</p>

<p>2.触发手势的轻拍次数  tap.numberOfTapsRequired = 2;</p>

<p>轻扫手势 UISwipeGestureRecognizer</p>

<p>包含的属性：指定轻扫的方向 swipe.direction = UISwipeGestureRecognizerDirectionUP/Down/Left/Right</p>

<table>
  <tbody>
    <tr>
      <td>可以同时指定方向相反的两个方向，中间用</td>
      <td>隔开；</td>
    </tr>
  </tbody>
</table>

<p>长按手势 UILongPressGestureRecognizer</p>

<p>包含的属性：长按手势触发的最短时间，默认是0.5秒 longPress.minimumPressDuration = 3.0;</p>

<p>缩放手势UIPinchGestureRecognizer</p>

<p>旋转手势 UIRotationGestureRecognizer</p>

<p>平移手势 UIPanGestureRecognizer</p>

<p>这三个手势无属性 但是相关联的方法中要改变视图的transform相关的值</p>

<p>缩放实现方法：</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="o">-</span> <span class="p">(</span><span class="n">void</span><span class="p">)</span><span class="n">pinchAction</span><span class="p">:(</span><span class="no">UIPinchGestureRecognizer</span> <span class="o">*</span><span class="p">)</span><span class="n">pinch</span> <span class="p">{</span>

<span class="no">UIImageView</span> <span class="o">*</span><span class="n">imageView</span> <span class="o">=</span> <span class="p">(</span><span class="no">UIImageView</span> <span class="o">*</span><span class="p">)</span><span class="n">pinch</span><span class="p">.</span><span class="nf">view</span><span class="p">;</span>

<span class="n">imageView</span><span class="p">.</span><span class="nf">transform</span> <span class="o">=</span> <span class="no">CGAffineTransformScale</span><span class="p">(</span><span class="n">imageView</span><span class="p">.</span><span class="nf">transform</span><span class="p">,</span> <span class="n">pinch</span><span class="p">.</span><span class="nf">scale</span><span class="p">.</span> <span class="nf">pinch</span><span class="p">.</span><span class="nf">scale</span><span class="p">);</span>

<span class="n">pinch</span><span class="p">.</span><span class="nf">scale</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span><span class="sr">//</span><span class="err">重定义改变比例，防止改变比例会累加而导致变化过快</span>

<span class="p">}</span></code></pre></figure>

<p>旋转实现方法：</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="o">-</span> <span class="p">(</span><span class="n">void</span><span class="p">)</span><span class="n">rotateAction</span><span class="p">:(</span><span class="no">UIRotationGestureRecognizer</span> <span class="o">*</span><span class="p">)</span><span class="n">rotate</span> <span class="p">{</span>

<span class="no">UIImageView</span> <span class="o">*</span><span class="n">imageView</span> <span class="o">=</span> <span class="p">(</span><span class="no">UIImageView</span> <span class="o">*</span><span class="p">)</span><span class="n">rotate</span><span class="p">.</span><span class="nf">view</span><span class="p">;</span>

<span class="n">imageView</span><span class="p">.</span><span class="nf">transform</span> <span class="o">=</span> <span class="no">CGAffineTransformRotate</span><span class="p">(</span><span class="n">imageView</span><span class="p">.</span><span class="nf">transform</span><span class="p">,</span> <span class="n">rotate</span><span class="p">.</span><span class="nf">rotation</span><span class="p">.</span><span class="nf">rotate</span><span class="p">.</span><span class="nf">rotation</span><span class="p">);</span>

<span class="n">rotate</span><span class="p">.</span><span class="nf">rotation</span><span class="o">=</span> <span class="mi">0</span><span class="p">;</span><span class="sr">//</span><span class="err">重定义改变比例，防止改变比例会累加而导致变化过快</span>

<span class="p">}</span></code></pre></figure>

<p>平移实现方法：</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="o">-</span> <span class="p">(</span><span class="n">void</span><span class="p">)</span><span class="n">panAction</span><span class="p">:(</span><span class="no">UIPanGestureRecognizer</span> <span class="o">*</span><span class="p">)</span><span class="n">pan</span> <span class="p">{</span>

<span class="no">UIImageView</span> <span class="o">*</span><span class="n">imageView</span> <span class="o">=</span> <span class="p">(</span><span class="no">UIImageView</span> <span class="o">*</span><span class="p">)</span><span class="n">pan</span><span class="p">.</span><span class="nf">view</span><span class="p">;</span>

<span class="no">CGPoint</span> <span class="nb">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">pan</span> <span class="n">translationInView</span><span class="ss">:imageView</span><span class="p">];</span>

<span class="n">imageView</span><span class="p">.</span><span class="nf">transform</span> <span class="o">=</span> <span class="no">CGAffineTransformTranslate</span><span class="p">(</span><span class="n">imageView</span><span class="p">.</span><span class="nf">transform</span><span class="p">,</span> <span class="nb">p</span><span class="p">.</span><span class="nf">x</span><span class="p">.</span> <span class="nf">p</span><span class="p">.</span><span class="nf">y</span><span class="p">);</span>

<span class="p">[</span><span class="n">pan</span> <span class="n">setTranslation</span><span class="ss">:CGPointZero</span> <span class="n">inView</span><span class="ss">:imageView</span><span class="p">];</span><span class="sr">//</span><span class="err">平移量归零</span>

<span class="p">}</span></code></pre></figure>

  </article>
</div>

      </div>
    </div>
    
    <footer class="footer">
  <div id="gotop">^</div>
  <br>
	NeighborWangShuShu@2016 Pithy Theme by Pawpaw.
</footer>

    
  </body>

</html>
